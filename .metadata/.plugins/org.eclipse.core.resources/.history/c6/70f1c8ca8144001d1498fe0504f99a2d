<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<%@ include file="../include/header.jsp" %>
<style type="text/css">
.fileDrop{
width:100%;
height: 200px;
border: 1px dotted blue;
}
</style>
<script type="text/javascript">
$(function(){
	//dragenter : 마우스가 대상 객체의 위로 처음 진입하게 될 때 
	//dragover: 드래그하면서 마우스가 대상 객체의 위에 자리잡고 있을 때
	$(".fileDrop").on("dragenter dragover",function(event){
		event.preventDefault();//자동으로 열리는 기본효과를 막음
	});
	$(".fileDrop").on("drop",function(event){
		event.preventDefault();//자동으로 열리는 기본효과를 막음
		//첨부파일이 여러개일 때 배열처리
		var files=event.originalEvent.dataTransfer.files;
		var file=files[0];//첫번째 첨부파일
		//formdata : ajax방식으로 파일업로드를 하는 핵심 객체(최신브라우저에서 지원(form태그와 같은역할))
		var formData=new FormData();
		formData.append("file",file);//폼에 file변수를 추가함
		//서버에 파일 업로드(ajax방식은 백그라운드에서 실행)
		$.ajax({
			type: "post",
			url : "${path}/upload/uploadAjax",
			data: formData,
			dataType : "text",
			prodessData: false,//파일전송시 자동으로 쿼리스트링형식으로 전송되지 않게설정
			contentType : false, //multipart/form-data로 처리되는 것과 같음
			success: function(data,status, req){
				console.log("data : "+ data);//업로드 된 파일이름
				console.log("status : "+ status);//성공실패 여부
				console.log("req : "+ req.status);//요청코드값
			}
		});
		
	});
	
});

</script>
</head>
<body>
<%@ include file="../include/menu.jsp" %>
<h2>Ajax File upload</h2>
<!-- 파일 업로드할 영역 -->
<div class="fileDrop"></div>
<!-- 업로드된 파일 목록을 출력할 영역 -->
<div class="uploadedList"></div>
</body>
</html>